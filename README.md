# Claude Code 機能検証手順書

このリポジトリでは、Claude Codeを現場で活用する前に必要な機能検証を体系的に行います。

## 目次

1. [検証環境の準備](#検証環境の準備)
2. [MCP（Model Context Protocol）機能検証](#mcp-機能検証)
3. [Hooks機能検証](#hooks機能検証)
4. [サブエージェント機能検証](#サブエージェント機能検証)
5. [GitHub Actions連携機能検証](#github-actions連携機能検証)
6. [検証結果の記録](#検証結果の記録)

## 検証環境の準備

### 前提条件
- Claude Codeがインストール済み
- Anthropic APIキーが設定済み
- Gitリポジトリが初期化済み

### 初期設定確認
```bash
# Claude Codeのバージョン確認
claude --version

# 設定ファイルの場所確認
claude config list

# 現在の設定内容確認
cat ~/.claude/settings.json
```

## MCP（Model Context Protocol）機能検証

### 検証目的
- 外部ツール・データベース・APIとの連携機能の動作確認
- MCPサーバーの設定と接続の検証
- 認証機能（OAuth 2.0）の動作確認

### 検証項目

#### 1. ローカルstdioサーバー接続検証
**目的**: ローカルプロセスとしてのMCPサーバー接続を確認

**手順**:
1. サンプルMCPサーバーのインストール
```bash
# 例：ファイルシステムMCPサーバー
npm install -g @modelcontextprotocol/server-filesystem
```

2. 設定ファイルの更新
```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["@modelcontextprotocol/server-filesystem", "/path/to/directory"]
    }
  }
}
```

3. 接続確認とテスト

**期待結果**: ローカルファイルシステムへのアクセスが可能

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 2. リモートSSEサーバー接続検証
**目的**: リアルタイムストリーミング接続の動作確認

**手順**:
1. SSEサーバー設定
2. 接続テスト
3. リアルタイムデータ受信確認

**期待結果**: リアルタイムでのデータストリーミング受信

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 3. OAuth 2.0認証機能検証
**目的**: セキュアな認証機能の動作確認

**手順**:
1. OAuth対応サービス（例：GitHub, Notion）との連携設定
2. 認証フローの実行
3. トークン自動更新の確認

**期待結果**: 安全な認証とトークン管理

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 4. 人気サービス連携検証
検証対象サービス:
- [ ] GitHub (Issues, PRs)
- [ ] Notion (データベース)
- [ ] Linear (プロジェクト管理)
- [ ] Sentry (エラートラッキング)
- [ ] Figma (デザインツール)

各サービスについて基本的な読み取り・書き込み操作を検証

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

## Hooks機能検証

### 検証目的
- カスタムコマンド実行機能の動作確認
- ツール使用制御機能の検証
- ワークフロー各段階での処理カスタマイズの確認

### 検証項目

#### 1. PreToolUse Hook検証
**目的**: ツール使用前の処理介入確認

**手順**:
1. バリデーションスクリプトの作成
```bash
#!/bin/bash
# validate-file-write.sh
echo "ファイル書き込み前の検証を実行中..."
# バリデーションロジック
exit 0  # 成功時は0を返す
```

2. Hook設定
```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write",
        "hooks": [
          {
            "type": "command",
            "command": "./scripts/validate-file-write.sh"
          }
        ]
      }
    ]
  }
}
```

3. 動作テスト

**期待結果**: ファイル書き込み前にバリデーションが実行される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 2. PostToolUse Hook検証
**目的**: ツール使用後の処理実行確認

**手順**:
1. ログ記録スクリプトの作成
2. Hook設定
3. 動作テスト

**期待結果**: ツール使用後にログが記録される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 3. UserPromptSubmit Hook検証
**目的**: プロンプト送信時の処理カスタマイズ確認

**手順**:
1. プロンプト拡張スクリプトの作成
2. Hook設定
3. 動作テスト

**期待結果**: ユーザープロンプトに自動的にコンテキストが追加される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 4. Stop Hook検証
**目的**: 処理停止時の清理作業確認

**手順**:
1. 清理スクリプトの作成
2. Hook設定
3. 動作テスト

**期待結果**: 処理停止時にリソースが適切に解放される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

## サブエージェント機能検証

### 検証目的
- 専門化されたエージェントの動作確認
- タスクの自動分散処理の検証
- エージェント間の連携機能の確認

### 検証項目

#### 1. general-purpose エージェント検証
**目的**: 汎用エージェントの機能確認

**手順**:
1. 複雑な検索タスクの実行
2. マルチステップタスクの実行
3. 結果の確認

**期待結果**: 複雑なタスクが自動的に分解・実行される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 2. statusline-setup エージェント検証
**目的**: ステータスライン設定エージェントの動作確認

**手順**:
1. ステータスライン設定タスクの実行
2. 設定結果の確認

**期待結果**: Claude Codeのステータスライン設定が正しく行われる

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 3. 同時実行機能検証
**目的**: 複数エージェントの並列実行確認

**手順**:
1. 複数の独立したタスクを同時実行
2. パフォーマンスとリソース使用量の監視
3. 結果の整合性確認

**期待結果**: 効率的な並列処理が実行される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 4. エージェント状態管理検証
**目的**: エージェントのステートレス動作確認

**手順**:
1. エージェントタスクの実行
2. 状態の独立性確認
3. メモリリークの確認

**期待結果**: 各エージェント実行が独立して動作する

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

## GitHub Actions連携機能検証

### 検証目的
- GitHub Actionsでの自動化機能確認
- セキュリティ設定の検証
- ワークフロー統合の確認

### 検証項目

#### 1. GitHub App インストール検証
**目的**: Claude GitHub Appの正しいインストール確認

**手順**:
1. GitHub Appのインストール
2. リポジトリ権限の確認
3. 基本動作テスト

**期待結果**: Appが適切にインストールされ基本機能が動作する

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 2. API キー設定検証
**目的**: セキュアなAPIキー管理の確認

**手順**:
1. GitHub Secretsへのキー登録
2. ワークフロー内でのキー参照確認
3. セキュリティ設定の検証

**期待結果**: APIキーが安全に管理・使用される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 3. ワークフローファイル設定検証
**目的**: GitHub Actionsワークフローの動作確認

**手順**:
1. サンプルワークフローファイルの作成
```yaml
name: Claude Code Test
on:
  issues:
    types: [opened, edited]
  issue_comment:
    types: [created]

jobs:
  claude-assist:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run Claude
        uses: anthropics/claude-action@v1
        with:
          api-key: ${{ secrets.ANTHROPIC_API_KEY }}
```

2. イベントトリガーのテスト
3. 実行結果の確認

**期待結果**: GitHub ActionsでClaude Codeが正常に動作する

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 4. @claude メンション機能検証
**目的**: Issueからの自動PR作成確認

**手順**:
1. テストIssueの作成
2. @claudeメンションでのタスク指示
3. 自動生成PRの確認
4. コード品質の検証

**期待結果**: Issueの内容に基づいて適切なPRが作成される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

---

#### 5. CLAUDE.md 設定検証
**目的**: プロジェクト固有設定の動作確認

**手順**:
1. CLAUDE.mdファイルの作成（コーディング規約等）
2. 規約に従ったコード生成の確認
3. 品質チェック

**期待結果**: プロジェクト固有の設定に従ってコードが生成される

**検証状況**: [ ] 未実施 [ ] 成功 [ ] 失敗
**備考**: 

## 検証結果の記録

### 検証サマリー

| 機能カテゴリ | 検証項目数 | 成功 | 失敗 | 未実施 | 成功率 |
|-------------|-----------|------|------|--------|--------|
| MCP機能 | 4 | - | - | - | -% |
| Hooks機能 | 4 | - | - | - | -% |
| サブエージェント | 4 | - | - | - | -% |
| GitHub Actions | 5 | - | - | - | -% |
| **合計** | **17** | **-** | **-** | **-** | **-%** |

### 発見された問題・課題

#### 重要度：高
- [ ] 問題なし

#### 重要度：中
- [ ] 問題なし

#### 重要度：低
- [ ] 問題なし

### 推奨事項

#### 本番導入前の必須対応事項
1. [ ] セキュリティ設定の最終確認
2. [ ] パフォーマンス監視体制の構築
3. [ ] エラーハンドリング機能の検証

#### 運用効率化のための推奨対応
1. [ ] 自動化スクリプトの整備
2. [ ] モニタリング仕組みの構築
3. [ ] ドキュメント整備

### 次のアクション

- [ ] 追加検証が必要な項目の特定
- [ ] 本番環境への展開計画策定
- [ ] チーム向けトレーニング計画作成

---

**最終更新日**: 2025-08-09
**検証担当者**: 
**承認者**: 